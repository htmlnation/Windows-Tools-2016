 <html>
<head>
<title>FortiClient</title>
<HTA:APPLICATION
  APPLICATIONNAME="FortiClient"
  ID="FortiClient"
  VERSION="1.0"/>
</head>

<script language="VBScript">
    Dim objShell :Set objShell = CreateObject("WScript.Shell")
    Dim dtmStartTime
    Dim oShell
   window.resizeTo 10,10
       
       
Sub Window_OnLoad
         objShell.Run "cmd.exe"
   idTimer = window.setTimeout("Forti1", 500, "VBScript")
End Sub

Sub Forti1
 objShell.SendKeys "if not exist c:\IT mkdir C:\IT"
 objShell.Sendkeys "{ENTER}" 
 objShell.SendKeys "echo robocopy \\fileshare\yourMSIfolder c:\it > c:\IT\finstall.bat"
 objShell.Sendkeys "{ENTER}" 
 objShell.SendKeys "echo msiexec /i c:\it\Yourmsiname.msi /passive >> c:\IT\finstall.bat"
 objShell.Sendkeys "{ENTER}" 
 objShell.SendKeys "echo reg import c:\IT\Settings.reg >> c:\IT\finstall.bat"
 objShell.Sendkeys "{ENTER}" 
 objShell.SendKeys "echo reg import c:\IT\Settings2.reg >> c:\IT\finstall.bat"
 objShell.Sendkeys "{ENTER}" 
 objShell.SendKeys "echo copy " & """C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Client\*.*""" & " " & "c:\users\public\desktop >> c:\IT\finstall.bat"
 objShell.Sendkeys "{ENTER}"
 idTimer = window.setTimeout("Adminmsccmd", 500, "VBScript")
End Sub


Sub Adminmsccmd
      objShell.Sendkeys "runas /user:domain\Administrator c:\IT\finstall.bat"
      idTimer = window.setTimeout("PZ1admin", 500, "VBScript")
End Sub

Sub PZ1admin
 objShell.Sendkeys "{ENTER}" 
 idTimer = window.setTimeout("PZ2admin", 500, "VBScript")
End Sub
   
Sub PZ2admin
    objShell.Sendkeys "adminPassword"
 objShell.Sendkeys "{ENTER}"
 objShell.Sendkeys "exit"
 objShell.Sendkeys "{ENTER}" 
 Self.close
End Sub    



</script>

<body bgcolor="white">

<!--Add your controls here-->

<!--{{InsertControlsHere}}-Do not remove this line-->
</body>
</html>